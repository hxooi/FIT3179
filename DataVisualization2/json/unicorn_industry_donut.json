{
  "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
  "width": 600,
  "height": 700,
  "title": {
    "text": "Distribution of Unicorn Companies by Industry",
    "fontSize": 14,
    "font": "Verdana"
  },
  "data": {
    "url": "https://raw.githubusercontent.com/hxooi/FIT3179/main/DataVisualization2/data/unicorn_industry_donut_alt.csv"
  },
  "params": [
    {
      "name": "country_selection",
      "bind": {
        "input": "select",
        "options": [
          "All Countries",
          "China",
          "United States",
          "Australia",
          "United Kingdom",
          "Bahamas",
          "India",
          "Indonesia",
          "Turkey",
          "Germany",
          "Hong Kong",
          "Seychelles",
          "Sweden",
          "Mexico",
          "Estonia",
          "Canada",
          "Netherlands",
          "France",
          "Israel",
          "Finland",
          "Colombia",
          "Belgium",
          "Brazil",
          "South Korea",
          "Denmark",
          "Switzerland",
          "Lithuania",
          "Austria",
          "Ireland",
          "Singapore",
          "Vietnam",
          "United Arab Emirates",
          "Argentina",
          "Spain",
          "Japan",
          "Luxembourg",
          "Nigeria",
          "Philippines",
          "Croatia",
          "Senegal",
          "Malaysia",
          "Bermuda",
          "Norway",
          "South Africa",
          "Ecuador",
          "Chile",
          "Thailand",
          "Czech Republic",
          "Italy"
        ],
        "labels": [
          "Show All",
          "China",
          "United States",
          "Australia",
          "United Kingdom",
          "Bahamas",
          "India",
          "Indonesia",
          "Turkey",
          "Germany",
          "Hong Kong",
          "Seychelles",
          "Sweden",
          "Mexico",
          "Estonia",
          "Canada",
          "Netherlands",
          "France",
          "Israel",
          "Finland",
          "Colombia",
          "Belgium",
          "Brazil",
          "South Korea",
          "Denmark",
          "Switzerland",
          "Lithuania",
          "Austria",
          "Ireland",
          "Singapore",
          "Vietnam",
          "United Arab Emirates",
          "Argentina",
          "Spain",
          "Japan",
          "Luxembourg",
          "Nigeria",
          "Philippines",
          "Croatia",
          "Senegal",
          "Malaysia",
          "Bermuda",
          "Norway",
          "South Africa",
          "Ecuador",
          "Chile",
          "Thailand",
          "Czech Republic",
          "Italy"
        ],
        "name": "Select Country: "
      }
    }
  ],
  "transform": [
    {
      "filter": "if(country_selection != null, datum.Country == country_selection, datum.Country == 'All Countries')"
    },
    {"joinaggregate": [{"op": "sum", "field": "Count", "as": "Total"}]},
    {"calculate": "(datum.Count / datum.Total) * 100", "as": "pct"},
    {"calculate": "round(datum.pct * 10) / 10", "as": "pct1"},
    {
      "calculate": "(datum.Count == 1 ? '1 company' : datum.Count + ' companies')",
      "as": "count_text"
    },
    {
      "calculate": "'In ' + datum.Country + ', the ' + datum.Industry + ' industry has ' + datum.count_text + ' unicorns (' + datum.pct1 + '% of total).'",
      "as": "tooltip_sentence"
    }
  ],
  "encoding": {
    "theta": {
      "field": "Count",
      "type": "quantitative",
      "scale": {"type": "linear"},
      "stack": true
    },
    "color": {
      "field": "Industry",
      "type": "nominal",
      "scale": {
        "domain": [
          "Artificial Intelligence",
          "Auto and transportation",
          "Consumer and retail",
          "Cybersecurity",
          "Data management and analytics",
          "E-commerce and direct-to-consumer",
          "Edtech",
          "Fintech",
          "Hardware",
          "Health",
          "Internet software and services",
          "Mobile and telecommunications",
          "Other",
          "Supply chain, logistics, and delivery",
          "Travel"
        ],
        "range": [
          "#357C3C",
          "#85C88A",
          "#E5CB9F",
          "#FFCCB3",
          "#FFAB76",
          "#FE7E6D",
          "#FFD372",
          "#C689C6",
          "#AC66CC",
          "#A799B7",
          "#B7657B",
          "#93ABD3",
          "#7692E4",
          "#3F52E3",
          "#2541B2"
        ]
      }
    },
    "tooltip": {"field": "tooltip_sentence", "type": "nominal", "title": ""}
  },
  "layer": [
    {"mark": {"type": "arc", "outerRadius": 300, "innerRadius": 200}},
    {
      "mark": {
        "type": "text",
        "radius": 350,
        "fontStyle": "bold",
        "font": "Verdana"
      },
      "encoding": {
        "text": {"field": "Industry", "type": "nominal"},
        "fillOpacity": {
          "condition": {
            "test": "datum['Count'] == 93 || datum['Count'] == 224 || datum['Count'] == 242 || datum['Count'] == 106",
            "value": 1
          },
          "value": 0
        },
        "color": {"value": "black"}
      }
    },
    {
      "mark": {
        "type": "text",
        "fontSize": 22,
        "fontStyle": "bold",
        "color": "black",
        "font": "Verdana"
      },
      "encoding": {
        "text": {"field": "Country", "type": "nominal"},
        "color": {"value": "black"}
      }
    }
  ],
  "config": {
    "view": {"stroke": null},
    "background": "#F6F6F6",
    "legend": {"labelFontSize": 10, "labelLimit": 180}
  }
}